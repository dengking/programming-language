# Segmentation fault



## 维基百科[Segmentation fault](https://en.wikipedia.org/wiki/Segmentation_fault)

In [computing](https://en.wikipedia.org/wiki/Computing), a **segmentation fault** (often shortened to **segfault**) or **access violation** is a [fault](https://en.wikipedia.org/wiki/Fault_(computing)), or failure condition, raised by hardware with [memory protection](https://en.wikipedia.org/wiki/Memory_protection), notifying an [operating system](https://en.wikipedia.org/wiki/Operating_system) (OS) the software has attempted to access a restricted area of memory (a memory access violation). On standard [x86](https://en.wikipedia.org/wiki/X86) computers, this is a form of [general protection fault](https://en.wikipedia.org/wiki/General_protection_fault). The OS [kernel](https://en.wikipedia.org/wiki/Kernel_(computing)) will, in response, usually perform some corrective action, generally passing the fault on to the offending [process](https://en.wikipedia.org/wiki/Process_(computing)) by sending the process a [signal](https://en.wikipedia.org/wiki/Signal_(computing)). Processes can in some cases install a custom signal handler, allowing them to recover on their own,[[1\]](https://en.wikipedia.org/wiki/Segmentation_fault#cite_note-Peter_Van_der_Linden-1) but otherwise the OS default signal handler is used, generally causing [abnormal termination](https://en.wikipedia.org/wiki/Abnormal_termination) of the process (a program [crash](https://en.wikipedia.org/wiki/Crash_(computing))), and sometimes a [core dump](https://en.wikipedia.org/wiki/Core_dump).

Segmentation faults are a common class of error in programs written in languages like [C](https://en.wikipedia.org/wiki/C_(programming_language)) that provide low-level memory access.  They arise primarily due to errors in use of [pointers](https://en.wikipedia.org/wiki/Pointer_(computer_programming)) for [virtual memory](https://en.wikipedia.org/wiki/Virtual_memory) addressing, particularly illegal access. Another type of memory access error is a [bus error](https://en.wikipedia.org/wiki/Bus_error), which also has various causes, but is today much rarer; these occur primarily due to incorrect *physical* memory addressing, or due to misaligned memory access – these are memory references that the hardware *cannot* address, rather than references that a process is not *allowed* to address.

Many programming languages may employ mechanisms designed to avoid segmentation faults and improve memory safety. For example, the [Rust programming language](https://en.wikipedia.org/wiki/Rust_(programming_language)) which appeared in 2010 employs an 'Ownership'[[2\]](https://en.wikipedia.org/wiki/Segmentation_fault#cite_note-2) based model to ensure memory safety,[[3\]](https://en.wikipedia.org/wiki/Segmentation_fault#cite_note-3) and garbage collection has been employed since around 1960,[[4\]](https://en.wikipedia.org/wiki/Segmentation_fault#cite_note-4) which avoids certain classes of memory errors which could lead to segmentation faults.[[5\]](https://en.wikipedia.org/wiki/Segmentation_fault#cite_note-5)

### Overview

A segmentation fault occurs when a program attempts to access a [memory](https://en.wikipedia.org/wiki/Computer_memory) location that it is not allowed to access, or attempts to access a memory location in a way that is not allowed (for example, attempting to write to a [read-only](https://en.wikipedia.org/wiki/Read-only_memory) location, or to overwrite part of the [operating system](https://en.wikipedia.org/wiki/Operating_system)).

The term "segmentation" has various uses in computing; in the context of "segmentation fault", a term used since the 1950s, it refers to the **address space of a *program***.[*citation needed*] With memory protection, only the program's own address space is readable, and of this, only the [stack](https://en.wikipedia.org/wiki/Call_stack) and the read-write portion of the [data segment](https://en.wikipedia.org/wiki/Data_segment) of a program are writable, while read-only data and the [code segment](https://en.wikipedia.org/wiki/Code_segment) are not writable. Thus attempting to read outside of the program's address space, or writing to a read-only segment of the address space, results in a segmentation fault, hence the name.

On systems using hardware [memory segmentation](https://en.wikipedia.org/wiki/Memory_segmentation) to provide [virtual memory](https://en.wikipedia.org/wiki/Virtual_memory), a segmentation fault occurs when the hardware detects an attempt to refer to a non-existent segment, or to refer to a location outside the bounds of a segment, or to refer to a location in a fashion not allowed by the permissions granted for that segment. On systems using only [paging](https://en.wikipedia.org/wiki/Paging), an [invalid page fault](https://en.wikipedia.org/wiki/Invalid_page_fault) generally leads to a segmentation fault, and segmentation faults and page faults are both faults raised by the [virtual memory](https://en.wikipedia.org/wiki/Virtual_memory) management system. Segmentation faults can also occur independently of page faults: illegal access to a valid page is a segmentation fault, but not an invalid page fault, and segmentation faults can occur in the middle of a page (hence no page fault), for example in a [buffer overflow](https://en.wikipedia.org/wiki/Buffer_overflow) that stays within a page but illegally overwrites memory.

At the hardware level, the fault is initially raised by the [memory management unit](https://en.wikipedia.org/wiki/Memory_management_unit) (MMU) on illegal access (if the referenced memory exists), as part of its memory protection feature, or an [invalid page fault](https://en.wikipedia.org/wiki/Invalid_page_fault) (if the referenced memory does not exist). If the problem is not an invalid logical address but instead an invalid physical address, a [bus error](https://en.wikipedia.org/wiki/Bus_error) is raised instead, though these are not always distinguished.

At the operating system level, this fault is caught and a signal is passed on to the offending process, activating the process's handler for that signal. Different operating systems have different signal names to indicate that a segmentation fault has occurred. On [Unix-like](https://en.wikipedia.org/wiki/Unix-like) operating systems, a signal called SIGSEGV (abbreviated from *segmentation violation*) is sent to the offending process. On [Microsoft Windows](https://en.wikipedia.org/wiki/Microsoft_Windows), the offending process receives a STATUS_ACCESS_VIOLATION [exception](https://en.wikipedia.org/wiki/Exception_handling).

